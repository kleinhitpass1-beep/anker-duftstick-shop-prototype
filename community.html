<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ankerstick Podcast | Prototype</title>
  <meta name="description" content="Podcast Bereich für Ankerstick. Episoden Übersicht, Player, Links. Prototype." />
  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <header>
    <div class="container">
      <div class="nav">
        <a class="brand" href="index.html" aria-label="Start">
          <span class="mark" aria-hidden="true"></span>
          <span>
            Ankerstick
            <small>Podcast</small>
          </span>
        </a>

        <nav class="links" aria-label="Navigation">
          <a class="link" href="index.html">Shop</a>
          <a class="link" href="product.html">Produkt</a>
          <a class="link" href="marketing.html">Marketing</a>
          <a class="link" href="community.html">Community</a>
          <a class="btn btnPrimary" href="podcast.html">
            Podcast <span class="badge" id="cartCount">0</span>
          </a>
        </nav>
      </div>
    </div>
  </header>

  <main>
    <section class="section">
      <div class="container">
        <div class="card shadowBig">
          <div class="padLg">
            <div class="kicker"><span class="dot" aria-hidden="true"></span> Prototype, Episoden als Platzhalter</div>
            <h1 style="margin-bottom:10px">Podcast</h1>
            <p class="lead" style="margin-bottom:0">
              Kurze Impulse für Ruhe, Selbstwahrnehmung und klare nächste Schritte. Professionell, respektvoll und ohne leere Versprechen.
            </p>
          </div>
        </div>
      </div>
    </section>

    <section class="section">
      <div class="container">
        <div class="productGrid">
          <!-- Left: Episodes -->
          <div class="card shadowBig">
            <div class="mediaTop">
              <div>
                <strong>Episoden</strong><br />
                <span>Wähle eine Episode aus</span>
              </div>

              <div style="display:flex; gap:10px; align-items:center; flex-wrap:wrap; justify-content:flex-end">
                <button class="btn btnSmall" type="button" id="seed">Beispiele laden</button>
                <button class="btn btnSmall btnGhost" type="button" id="resetPodcast">Reset</button>
              </div>
            </div>

            <div class="pad" id="episodeList"></div>
          </div>

          <!-- Right: Player -->
          <aside class="card shadowBig">
            <div class="padLg">
              <div class="kicker"><span class="dot" aria-hidden="true"></span> Jetzt abspielen</div>

              <div style="font-weight:900; font-size:18px; margin-top:12px" id="epTitle">
                Keine Episode ausgewählt
              </div>

              <div style="color:var(--muted); margin-top:8px" id="epMeta">
                Wähle links eine Episode.
              </div>

              <div style="margin-top:14px">
                <audio id="player" controls style="width:100%"></audio>
              </div>

              <div class="fineprint" id="epDesc" style="margin-top:14px">
                Hinweis: Im Prototyp sind Audio Dateien optional. Später kannst du Spotify, Apple Podcasts oder eine RSS Quelle anbinden.
              </div>

              <div class="ctaRow" style="justify-content:flex-start">
                <a class="btn btnSmall" id="linkSpotify" href="#" target="_blank" rel="noreferrer">Spotify</a>
                <a class="btn btnSmall" id="linkApple" href="#" target="_blank" rel="noreferrer">Apple Podcasts</a>
                <a class="btn btnSmall" id="linkWeb" href="#" target="_blank" rel="noreferrer">Web</a>
              </div>
            </div>
          </aside>

        </div>
      </div>
    </section>

    <footer>
      <div class="container">
        <div class="foot">
          <div>
            <strong style="color:var(--text)">Ankerstick Podcast</strong><br />
            <span>Prototype Bereich für Content und Markenaufbau</span>
          </div>
          <div>
            <a class="link" href="community.html">Zur Community</a>
          </div>
        </div>
      </div>
    </footer>
  </main>

  <!-- App logic -->
  <script src="app.js"></script>

  <!-- Page logic -->
  <script>
    function escapeHtml(s){
      return String(s || "")
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    function renderEpisodes(){
      const list = document.getElementById("episodeList");
      const eps = (typeof loadPodcastEpisodes === "function") ? loadPodcastEpisodes() : [];

      if(!list) return;

      if(eps.length === 0){
        list.innerHTML = `<div style="color:var(--muted)">Noch keine Episoden. Klicke auf Beispiele laden.</div>`;
        return;
      }

      list.innerHTML = eps.map(ep => `
        <div class="card" style="margin-bottom:12px">
          <div class="pad">
            <div style="display:flex; justify-content:space-between; gap:12px; align-items:flex-start; flex-wrap:wrap">
              <div>
                <div class="kicker" style="margin-bottom:10px"><span class="dot" aria-hidden="true"></span> Episode ${escapeHtml(ep.number)}</div>
                <div style="font-weight:900; font-size:16px">${escapeHtml(ep.title)}</div>
                <div style="color:var(--muted); font-size:13.5px; margin-top:6px; line-height:1.55">
                  ${escapeHtml(ep.teaser || "")}
                </div>
              </div>
              <div style="display:flex; gap:10px; align-items:center">
                <button class="btn btnPrimary btnSmall" type="button" onclick="selectEpisode('${ep.id}')">Abspielen</button>
              </div>
            </div>
          </div>
        </div>
      `).join("");
    }

    function selectEpisode(id){
      const eps = (typeof loadPodcastEpisodes === "function") ? loadPodcastEpisodes() : [];
      const ep = eps.find(e => e.id === id);
      if(!ep) return;

      document.getElementById("epTitle").textContent = ep.title || "Episode";
      document.getElementById("epMeta").textContent =
        `Episode ${ep.number || ""} · ${ep.duration || ""} · ${ep.publishedAt ? new Date(ep.publishedAt).toLocaleDateString("de-DE") : ""}`;

      document.getElementById("epDesc").textContent = ep.description || "";

      const player = document.getElementById("player");
      player.src = ep.audioUrl || "";

      if(ep.audioUrl){
        player.play().catch(() => {});
      }

      document.getElementById("linkSpotify").href = ep.spotifyUrl || "#";
      document.getElementById("linkApple").href = ep.appleUrl || "#";
      document.getElementById("linkWeb").href = ep.webUrl || "#";
    }

    // Buttons
    document.getElementById("seed").addEventListener("click", () => {
      if(typeof seedPodcastEpisodes === "function"){
        seedPodcastEpisodes();
      }
      renderEpisodes();
    });

    document.getElementById("resetPodcast").addEventListener("click", () => {
      localStorage.removeItem("anker_podcast_v1");
      alert("Podcast Daten zurückgesetzt. Jetzt bitte auf „Beispiele laden“ klicken.");
      location.reload();
    });

    document.addEventListener("DOMContentLoaded", () => {
      if(typeof setCartBadge === "function") setCartBadge();
      renderEpisodes();
    });
  </script>
</body>
</html>

