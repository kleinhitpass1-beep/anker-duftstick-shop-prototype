<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>an:care Stick Calm | Produkt</title>
  <meta name="description" content="Produktdetailseite für an:care Stick Calm. Prototyp mit lokalem Warenkorb." />
  <link rel="icon" type="image/png" href="favicon.png">
  <link rel="apple-touch-icon" href="favicon.png">
  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <header>
    <div class="container">
      <div class="nav">
        <a class="brand" href="index.html" aria-label="Zur Startseite">
          <img class="logo" src="logo-v2.jpg" alt="an:care Logo" />
          <span>
            an:care
            <small>Produktdetails</small>
          </span>
        </a>

        <nav class="links" aria-label="Navigation">
          <a class="link" href="shop.html">Shop</a>
          <a class="link" href="community.html">Community</a>
          <a class="link" href="marketing.html">Marketing</a>
          <a class="link" href="podcast.html">Podcast</a>
          <a class="link" href="blog.html">Blog</a>
          <a class="btn btnPrimary" href="#warenkorb">
            Warenkorb <span class="badge" id="cartCount">0</span>
          </a>
        </nav>
      </div>
    </div>
  </header>

  <main>
    <!-- Produktbereich -->
    <section class="section">
      <div class="container">
        <div class="productGrid">
          <!-- Galerie -->
          <div class="card shadowBig">
            <div class="mediaTop">
              <div>
                <strong>Galerie</strong><br />
                <span>Klicke auf ein Thumbnail</span>
              </div>
              <span class="kicker" style="margin:0">an:care Stick</span>
            </div>

            <div class="pad">
              <img id="mainImage" class="galleryMain" src="anker8-v2.jpg" alt="an:care Stick Calm Produktbild" />

              <div class="thumbs" aria-label="Thumbnails">
                <img class="thumb" src="anker3-v2.jpg" alt="Packshot" data-src="anker3-v2.jpg" />
                <img class="thumb" src="anker4-v2.jpg" alt="Regal Foto" data-src="anker4-v2.jpg" />
                <img class="thumb" src="anker5-v2.jpg" alt="Verpackung" data-src="anker5-v2.jpg" />
              </div>

              <div class="fineprint">
                Hinweis: Produktdarstellung im Prototyp. Aussagen sind auf Wohlbefinden und Entspannung ausgerichtet.
                Keine medizinischen Versprechen.
              </div>
            </div>
          </div>

          <!-- Details -->
          <aside class="card shadowBig" id="details">
            <div class="padLg">
              <div class="kicker"><span class="dot" aria-hidden="true"></span> an:care Stick Calm</div>
              <h1 style="margin-bottom:8px">Dein Moment der Ruhe</h1>

              <div style="display:flex; align-items:center; justify-content:space-between; gap:12px; flex-wrap:wrap">
                <div class="price" style="font-size:14px">13,99 EUR</div>
                <div style="color:var(--muted); font-size:13.5px">Lieferzeit 1-2 Tage</div>
              </div>

              <p class="lead" style="margin-top:12px">
                Ein Duftstick für Übergänge: vor Terminen, nach Reizüberflutung, am Abend.
                Diskret und ohne Aufwand.
              </p>

              <div class="tagRow">
                <span class="tag">Neroli</span>
                <span class="tag">Kokosöl</span>
              </div>

              <div class="field">
                <label for="qty">Menge</label>
                <input id="qty" type="number" min="1" value="1" />
              </div>

              <div class="ctaRow" style="margin-top:14px">
                <button class="btn btnPrimary" type="button" id="addBtn">In den Warenkorb</button>
                <button class="btn" type="button" id="buyBtn">Checkout Prototyp</button>
              </div>

              <div class="fineprint">
                Sicherheit: Nicht in die Augen bringen. Außer Reichweite von Kindern.
                Bei Allergien, Schwangerschaft oder Asthma bitte fachlich abklären.
              </div>

              <div class="fineprint" style="margin-top:10px">
                Hinweis: Weitere Sorten (Focus, Balance, Sleep) sind in Vorbereitung. Interesse kannst du im Shop hinterlassen.
              </div>

              <div class="ctaRow" style="margin-top:12px">
                <a class="btn" href="shop.html">Zum Shop</a>
              </div>
            </div>
          </aside>
        </div>
      </div>
    </section>

    <!-- Warenkorb -->
    <section class="section" id="warenkorb">
      <div class="container">
        <div class="sectionHeader">
          <div>
            <h2>Warenkorb</h2>
            <p>Im Prototyp speichern wir nur lokal im Browser, kein echter Kauf.</p>
          </div>
        </div>

        <div class="card shadowBig">
          <div class="pad cartLayout">

            <!-- Links -->
            <div class="cartMain">
              <div id="miniCart"></div>

              <div class="cartRow" style="margin-top:12px">
                <div style="color:var(--muted); font-size:13.5px">Zwischensumme</div>
                <div class="price" id="miniCartTotal">0,00 EUR</div>
              </div>

              <div class="ctaRow" style="margin-top:12px">
                <button class="btn btnPrimary" type="button" id="fakePay">Fiktive Bestellung auslösen</button>
                <button class="btn" type="button" id="clear">Warenkorb leeren</button>
              </div>

              <div class="fineprint" id="success" style="display:none">
                Erfolg im Prototyp. Bestellung ausgelöst. Es wurde keine echte Zahlung ausgeführt.
              </div>
            </div>

            <!-- Rechts -->
            <aside class="cartSide">
              <div class="card shadowBig">
                <div class="padLg">
                  <div style="font-weight:900; margin-bottom:10px">Versand und Zahlung</div>

                  <div class="field">
                    <label for="shippingSelect">Versand</label>
                    <select id="shippingSelect">
                      <option value="3.99">DHL Versand 3,99 EUR</option>
                      <option value="0">Abholung 0,00 EUR</option>
                    </select>
                  </div>

                  <div class="field" style="margin-top:14px">
                    <label>Zahlungsart</label>
                    <div style="display:grid; gap:10px">
                      <label style="display:flex; gap:10px; align-items:center; margin:0">
                        <input type="radio" name="paymentMethod" value="paypal" checked />
                        PayPal
                      </label>

                      <label style="display:flex; gap:10px; align-items:center; margin:0">
                        <input type="radio" name="paymentMethod" value="rechnung" />
                        Rechnung
                      </label>

                      <label style="display:flex; gap:10px; align-items:center; margin:0">
                        <input type="radio" name="paymentMethod" value="kreditkarte" />
                        Kreditkarte
                      </label>
                    </div>
                  </div>

                  <div class="cartRow" style="margin-top:14px">
                    <div style="color:var(--muted); font-size:13.5px">Gesamtsumme inkl Versand</div>
                    <div class="price" id="grandTotal">0,00 EUR</div>
                  </div>

                  <div class="fineprint" style="margin-top:12px">
                    Hinweis: Prototyp. Auswahl wird lokal im Browser gespeichert.
                  </div>
                </div>
              </div>
            </aside>

          </div>
        </div>
      </div>
    </section>

    <footer>
      <div class="container">
        <div class="foot">
          <div>
            <strong style="color:var(--text)">an:care GmbH</strong><br />
          </div>

          <div style="display:flex; gap:16px; flex-wrap:wrap;">
            <a class="link" href="FAQ.html">FAQ</a>
            <a class="link" href="impressum.html">Impressum</a>
            <a class="link" href="datenschutz.html">Datenschutz</a>
          </div>
        </div>
      </div>
    </footer>
  </main>

  <script src="app.js"></script>
  <script>
    const product = { id:"ancare_stick_calm", name:"an:care Stick Calm", note:"Neroli Kokosöl", price:13.99 };

    // Thumbnails
    document.querySelectorAll(".thumb").forEach((t) => {
      t.addEventListener("click", () => {
        const src = t.getAttribute("data-src");
        const main = document.getElementById("mainImage");
        if (main && src) main.src = src;
      });
    });

    function ensure(fnName){
      return (typeof window[fnName] === "function");
    }

    function parseEUR(text){
      const s = String(text || "0").replace(/\s/g, "");
      const m = s.match(/[\d.,]+/);
      if(!m) return 0;
      return parseFloat(m[0].replace(".", "").replace(",", "."));
    }

    function formatEUR(n){
      return (Number(n || 0)).toFixed(2).replace(".", ",") + " EUR";
    }

    function updateGrandTotal(){
      const subtotal = parseEUR(document.getElementById("miniCartTotal")?.textContent);
      const ship = parseFloat(document.getElementById("shippingSelect")?.value || "0");
      const out = document.getElementById("grandTotal");
      if(out) out.textContent = formatEUR(subtotal + ship);
    }

    function syncShippingAndPaymentFromStorage(){
      const ship = localStorage.getItem("ancare_shipping_v1");
      const sel = document.getElementById("shippingSelect");
      if(ship && sel) sel.value = ship;

      const pay = localStorage.getItem("ancare_payment_v1");
      if(pay){
        const r = document.querySelector(`input[name="paymentMethod"][value="${pay}"]`);
        if(r) r.checked = true;
      }
    }

    document.getElementById("shippingSelect")?.addEventListener("change", (e) => {
      localStorage.setItem("ancare_shipping_v1", e.target.value);
      updateGrandTotal();
    });

    document.querySelectorAll('input[name="paymentMethod"]').forEach(r => {
      r.addEventListener("change", () => {
        localStorage.setItem("ancare_payment_v1", r.value);
      });
    });

    document.getElementById("addBtn")?.addEventListener("click", () => {
      if(!ensure("addToCart")){
        alert("Fehler: app.js wurde nicht geladen. Bitte Seite neu laden (Ctrl+F5).");
        return;
      }

      const qty = Math.max(1, parseInt(document.getElementById("qty")?.value || "1", 10));

      window.addToCart({
        id: product.id,
        name: product.name,
        note: product.note,
        price: product.price,
        qty
      });

      window.renderMiniCart?.();
      window.setCartBadge?.();
      updateGrandTotal();
      alert("Im Prototyp hinzugefügt.");
    });

    document.getElementById("buyBtn")?.addEventListener("click", () => {
      document.getElementById("warenkorb")?.scrollIntoView({ behavior: "smooth" });
    });

    document.getElementById("fakePay")?.addEventListener("click", () => {
      if(!ensure("loadCart") || !ensure("clearCart")){
        alert("Fehler: app.js wurde nicht geladen. Bitte Seite neu laden (Ctrl+F5).");
        return;
      }

      const cart = window.loadCart();
      if(cart.length === 0){
        alert("Warenkorb ist leer.");
        return;
      }

      window.clearCart();
      window.renderMiniCart?.();
      window.setCartBadge?.();
      updateGrandTotal();

      const success = document.getElementById("success");
      if(success) success.style.display = "block";
    });

    document.getElementById("clear")?.addEventListener("click", () => {
      if(!ensure("clearCart")){
        alert("Fehler: app.js wurde nicht geladen. Bitte Seite neu laden (Ctrl+F5).");
        return;
      }

      window.clearCart();
      window.renderMiniCart?.();
      window.setCartBadge?.();
      updateGrandTotal();

      const success = document.getElementById("success");
      if(success) success.style.display = "none";
    });

    document.addEventListener("DOMContentLoaded", () => {
      syncShippingAndPaymentFromStorage();

      window.renderMiniCart?.();
      window.setCartBadge?.();

      updateGrandTotal();
    });
  </script>
</body>
</html>
